! Spine-1 Configuration
! VxLAN EVPN Spine-Leaf Topology
! Role: Route Reflector for EVPN Overlay

hostname Spine-1

! Enable required features
feature bgp
feature interface-vlan

! Configure VRF for management
vrf context management
  ip route 0.0.0.0/0 192.168.1.254

! Loopback for BGP Router ID
interface loopback0
  description BGP Router-ID
  ip address 10.0.0.1/32

! Point-to-Point Links to Leaf Switches
interface Ethernet1/1
  description Link to Leaf-1
  no switchport
  mtu 9216
  ip address 10.1.1.0/31
  no shutdown

interface Ethernet1/2
  description Link to Leaf-2
  no switchport
  mtu 9216
  ip address 10.1.1.2/31
  no shutdown

! Management Interface
interface mgmt0
  vrf member management
  ip address 192.168.1.1/24

! BGP Configuration
router bgp 65000
  router-id 10.0.0.1
  log-neighbor-changes
  address-family ipv4 unicast
    network 10.0.0.1/32
  address-family l2vpn evpn
    retain route-target all
  
  ! BGP Peering with Leaf-1
  neighbor 10.0.0.11
    remote-as 65001
    description Leaf-1
    update-source loopback0
    ebgp-multihop 2
    address-family l2vpn evpn
      send-community
      send-community extended
      route-reflector-client
  
  ! BGP Peering with Leaf-2
  neighbor 10.0.0.12
    remote-as 65002
    description Leaf-2
    update-source loopback0
    ebgp-multihop 2
    address-family l2vpn evpn
      send-community
      send-community extended
      route-reflector-client
  
  ! Underlay BGP - Leaf-1
  neighbor 10.1.1.1
    remote-as 65001
    description Leaf-1-Underlay
    address-family ipv4 unicast
  
  ! Underlay BGP - Leaf-2
  neighbor 10.1.1.3
    remote-as 65002
    description Leaf-2-Underlay
    address-family ipv4 unicast

! End of Configuration
